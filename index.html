<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>File(s) size</title>
</head>

<body>
<form name="uploadForm">
    <div>
        <input id="uploadInput" type="file">
        selected files: <span id="fileNum">0</span>;
        total size: <span id="fileSize">0</span>
    </div>
</form>

<script>
    function uploadFile() {
        let nBytes = 0, oFiles = this.files, nFiles = oFiles.length
        for (let nFileId = 0; nFileId < nFiles; nFileId++) {
            nBytes += oFiles[nFileId].size
        }
        let sOutput = nBytes + " bytes"
        // optional code for multiples approximation
        const units = ["KiB", "MiB", "GiB", "TiB", "PiB", "EiB", "ZiB", "YiB"]
        for (let nm = 0, na = nBytes / 1024; na > 1; na /= 1024, nm++) {
            sOutput = na.toFixed(3) + " " + units[nm] + " (" + nBytes + " bytes)"
        }
        // end of optional code
        document.getElementById("fileNum").innerHTML = nFiles.toString()
        document.getElementById("fileSize").innerHTML = sOutput

        let file = oFiles[0]

        // https://stackoverflow.com/questions/7431365/filereader-readasbinarystring-to-upload-files/17512132#17512132
        // file is an instance of File, e.g. from a file input.
        let xhr = new XMLHttpRequest()
        xhr.open("POST", '/pushfile', true)
        xhr.setRequestHeader('Content-Filename', file.name)
        xhr.setRequestHeader("Content-Type", file.type)

        // Send the binary data.
        // Since a File is a Blob, we can send it directly.
        xhr.send(file)
    }

    let el = document.getElementById("uploadInput");
    el.addEventListener("change", uploadFile, false);
</script>
</body>

</html>